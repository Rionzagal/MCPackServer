@page "/Report/{id}"
@inject IPurchaseOrdersService _ordersService
@inject IArticlesToPurchaseService _articlesService

<MudText Typo="Typo.h3" Align="Align.Center">REPORTE PARA OREN DE COMPRA @Id</MudText>

<MudButton Variant="Variant.Filled" Color="Color.Info" Class="m-3"
           OnClick="Return">
    Regresar a órdenes de compra
</MudButton>
<MudButton Variant="Variant.Filled" Color="Color.Primary" OnClick="Print" Class="m-3">
    Imprimir
</MudButton>
<div class="col-12" style="left: 20% ;width: 700px; height: 842px; border: 2px solid black; position: absolute;">
    <div style="width: 100%; height: 100%; padding: 10px 10px 10px 10px; position: absolute;" id="DocumentBody" >
        <div style="position: absolute; left: 0px; top: 0px; width: 64px; height: 40px;">
            <img src="../img/McLogo.PNG" alt="Logo" />
        </div>
        <div style="position: absolute; left: 134px; right: 134px; text-align: center;
                    line-height: 22px;">
            <span style="color: rgb(0, 0, 128);">
                <span style="font-family: Arial, Helvetica, sans-serif; font-weight: bold; font-size: 20px;">
                    MC ENGINEERING, S.A. DE C.V.
                </span>
                <br />
                <span style="font-family: 'Times New Roman'; font-size: 10px;">
                    Av. Juan Pablo II  # 1371, Col. Postes Cuates, Guadalajara, Jalisco C.P. 44350 <br />
                    Teléfono (33) 3168 9947, Teléfono y Fax: 3331 1172 <br />
                </span>
                <span style="font-family: 'Times New Roman'; font-size: 16px;">
                    <b>RFC: ENG0605155LA</b>
                </span>
            </span>
        </div>

        <div style="position: absolute; right: 0px; top: 80px;">
            <h6 style="font-family: 'Times New Roman'; font-size: 18px; color: rgb(0, 0, 128);">
                ORDEN DE COMPRA No. @Order.Id
            </h6>
        </div>

        <div style="position: absolute; left: 0px; right: 0px; top: 150px; height: 100px; border: solid; border-color: rgb(0, 0, 128);">
            <div style="position: absolute; left: 10px; top: 0px">
                FECHA DE SOLICITUD: @(Order.IssuedDate.HasValue ? Order.IssuedDate.Value.ToShortDateString() : "N/A")
            </div>
            <div style="position: absolute; right: 10px; top: 0px; ">
                FECHA DE ENTREGA: @(Order.DeliveryDate.HasValue ? Order.DeliveryDate.Value.ToShortDateString() : "N/A")
            </div>
            <div style="position: absolute; left: 10px; top: 40px; bottom: 40px; ">
                PROVEEDOR: @OrderProvider.LegalName
            </div>
            <div style="position: absolute; left: 10px; bottom: 0px; text-align: center ">
                CONDICIONES: @OrderProvider.PaymentCondition
            </div>
            <div style="position: absolute; right: 10px; bottom: 0px; ">
                MONEDA: @Order.Currency
            </div>
        </div>

        <div style="position: absolute; left: 0px; right: 0px; top: 270px; bottom: 730px;">
            <table style="width: 100%">
                <colgroup>
                    <col style="width: 5%" />
                    <col style="width: 5%" />
                    <col style="width: 10%" />
                    <col style="width: 50%" />
                    <col style="width: 10%" />
                    <col style="width: 20%" />
                </colgroup>
                <thead>
                    <tr style="font-size: 18px; border-bottom: 2px solid rgb(0, 0, 128);">
                        <th>
                            <h5 style="color: rgb(0, 0, 128);">No.</h5>
                        </th>
                        <th>
                            <h5 style="color: rgb(0, 0, 128);">Cant.</h5>
                        </th>
                        <th>
                            <h5 style="color: rgb(0, 0, 128);">Unidad</h5>
                        </th>
                        <th>
                            <h5 style="color: rgb(0, 0, 128);">Descripción</h5>
                        </th>
                        <th>
                            <h5 style="color: rgb(0, 0, 128);">Precio</h5>
                        </th>
                        <th>
                            <h5 style="color: rgb(0, 0, 128);">Total</h5>
                        </th>
                    </tr>
                </thead>
                <tbody>
                    @for (int i = 0; i < OrderArticles.Count; i++)
                    {
                        <tr style="height: 35px; padding: 5px; font: normal 12px arial">
                            <td>
                                @MaterialNumbers[i]
                            </td>
                            <td>
                                @OrderArticles[i].Quantity
                            </td>
                            <td>
                                @OrderArticles[i].Quote.Article.Unit
                            </td>
                            <td>
                                @OrderArticles[i].Quote.Article.Description
                            </td>
                            <td>
                                @($"${OrderArticles[i].SalePrice.ToString("n2")}")
                            </td>
                            <td>
                                @($"${(OrderArticles[i].SalePrice * OrderArticles[i].Quantity).ToString("n2")} {Order.Currency}")
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>

        <div style="position: absolute; left: 0px; right: 0px; bottom: 0px; height: 112px; border: solid; border-color: rgb(0, 0, 128);">
            <div style="position: absolute; left: 0px; top: 0px; font-size: 10px; line-height: 12px;">
                <div style="position: absolute; width: 100px; padding: 5px 0px 0px 5px; ">
                    PROY: @OrderProject.ProjectNumber
                </div>
                <div style="position: absolute; left: 100px; width: 75px; padding: 5px 0px 0px 5px; ">
                    @ProjectClient.MarketName
                </div>
                <div style="position: absolute; left: 200px; width: 200px; padding: 5px 0px 0px 5px; ">
                    @OrderProject.Description
                </div>
            </div>
            <div style="position: absolute; left: 357px; right: 125px; height: 100%; text-align: right; vertical-align: central;">
                <div>
                    <span style="color: rgb(0, 0, 128)">
                        Descuento: @Order.Discount%
                    </span>
                </div>
                <div>
                    <span style="color: rgb(0, 0, 128)">
                        Subtotal
                    </span>
                </div>
                <div>
                    <span style="color: rgb(0, 0, 128)">
                        I.V.A.
                    </span>
                </div>
                <div>
                    <span style="color: rgb(0, 0, 128)">
                        Total
                    </span>
                </div>
            </div>
            <div style="position: absolute; left: 506px; right: 5px; height: 100px; text-align: right; vertical-align: central;">
                <div>
                    <span style="color: black">
                        $@Discount.ToString("n2") @Order.Currency
                    </span>
                </div>
                <div>
                    <span style="color: black">
                        $@Subtotal.ToString("n2") @Order.Currency
                    </span>
                </div>
                <div>
                    <span style="color: black">
                        $@Tax.ToString("n2") @Order.Currency
                    </span>
                </div>
                <div>
                    <span style="color: black">
                        $@Total.ToString("n2") @Order.Currency
                    </span>
                </div>
            </div>
            <div style="position: absolute; left: 1.18%; right: 50%; top: 30%; bottom: 6.25%;">
                <div style="position: absolute; left: 20%; right: 20%; text-align: center">
                    <span style="font-size: 20px; color: rgb(0, 0, 128);">
                        AUTORIZA
                    </span>
                </div>
                <div style="position: absolute; top: 60%; bottom: 0%; left: 0%; right: 55%; text-align: center; vertical-align: text-top; border-top-width: 1px; border-top: solid; border-top-color: rgb(0, 0, 128);">
                    <span style="font-size: 10px;">
                        Compras
                    </span>
                </div>
                <div style="position: absolute; top: 60%; bottom: 0%; left: 55%; right: 0%; text-align: center; vertical-align: text-top; border-top-width: 1px; border-top: solid; border-top-color: rgb(0, 0, 128);">
                    <span style="font-size: 10px">
                        Dirección <br />
                        Ing. Mario González Cervantes
                    </span>
                </div>
            </div>
        </div>
    </div>
</div>